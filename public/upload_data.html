<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Upload Data</title>
    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css"
      rel="stylesheet"
    />
  </head>
  <body>
    <div class="container my-5">
      <h1 class="text-center mb-4">Upload New Data</h1>

      <div class="card shadow-sm mx-auto" style="max-width: 600px">
        <div class="card-body">
          <form id="uploadForm" class="row g-3">
            <!-- Name Field -->
            <div class="col-12">
              <label for="name" class="form-label">Name</label>
              <input
                type="text"
                id="name"
                class="form-control"
                placeholder="Enter name"
                required
              />
            </div>

            <!-- Description Field -->
            <div class="col-12">
              <label for="description" class="form-label">Description</label>
              <textarea
                id="description"
                class="form-control"
                rows="3"
                placeholder="Enter description"
                required
              ></textarea>
            </div>

            <!-- Tags Field -->
            <div class="col-12">
              <label for="tags" class="form-label"
                >Tags (comma separated)</label
              >
              <input
                type="text"
                id="tags"
                class="form-control"
                placeholder="E.g., research, data"
                required
              />
            </div>

            <!-- Source Field -->
            <div class="col-12">
              <label for="source" class="form-label">Source</label>
              <input
                type="text"
                id="source"
                class="form-control"
                placeholder="Enter source"
                required
              />
            </div>

            <!-- Date Field -->
            <div class="col-md-6">
              <label for="date" class="form-label">Date</label>
              <input type="date" id="date" class="form-control" required />
            </div>

            <!-- Download Link Field -->
            <div class="col-md-6">
              <label for="downloadLink" class="form-label">Download Link</label>
              <input
                type="url"
                id="downloadLink"
                class="form-control"
                placeholder="Enter download URL"
                required
              />
            </div>

            <!-- Submit Button -->
            <div class="col-12 text-center">
              <button
                type="button"
                onclick="submitData()"
                class="btn btn-primary mt-3"
              >
                Submit
              </button>
            </div>
          </form>

          <!-- Response Message -->
          <div id="responseMessage" class="mt-3 text-center"></div>
        </div>
      </div>
    </div>

    <script>
      async function submitData() {
        const data = {
          name: document.getElementById("name").value,
          description: document.getElementById("description").value,
          tags: document.getElementById("tags").value,
          source: document.getElementById("source").value,
          date: document.getElementById("date").value,
          downloadLink: document.getElementById("downloadLink").value,
        };

        const issueTitle = `New Data: ${data.name}`;
        const issueBody = JSON.stringify(data, null, 2);

        await fetch(
          "https://api.github.com/repos/YeshuoShu/ExampleWebsite/issues",
          {
            method: "POST",
            headers: {
              Authorization: `Bearer ${process.env.GITHUB_TOKEN}`,
              "Content-Type": "application/json",
            },
            body: JSON.stringify({
              title: issueTitle,
              body: issueBody,
            }),
          }
        )
          .then((response) => response.json())
          .then((result) => {
            document.getElementById("responseMessage").textContent =
              "Data submitted successfully!";
            document.getElementById("uploadForm").reset();
          })
          .catch((error) => {
            document.getElementById("responseMessage").textContent =
              "Error: " + error.message;
          });
      }
    </script>
  </body>
</html>
